using System.Text;

namespace GuessTheWord
{
    public partial class Csharp_GuessWordGame : Form
    {
        private string secretWord = "Windows"; 
        private string hiddenWord; 

        public Csharp_GuessWordGame()
        {
            InitializeComponent();
            InitializeGame();
        }

        private void InitializeGame()
        {
           
            var sb = new StringBuilder(secretWord);
            for (int i = 1; i < secretWord.Length - 1; i++)
            {
                if (char.IsLetter(secretWord[i]))
                    sb[i] = '?';
            }

            hiddenWord = sb.ToString();
            lblWord.Text = hiddenWord;  
        }

       
        private string Normalize(string s)
        {
            if (string.IsNullOrEmpty(s)) return string.Empty;
            var sb = new StringBuilder();
            foreach (char c in s)
                if (char.IsLetterOrDigit(c))
                    sb.Append(char.ToLowerInvariant(c));
            return sb.ToString();
        }

        private void btnGuess_Click(object sender, EventArgs e)
        {
            string guess = txtGuess.Text.Trim();

            if (string.IsNullOrEmpty(guess))
            {
                MessageBox.Show("Please enter a guess!", "Error");
                return;
            }

            string normalizedGuess = Normalize(guess);
            string normalizedSecret = Normalize(secretWord);


            if (normalizedGuess == normalizedSecret)
            {
                lblWord.Text = secretWord;
                MessageBox.Show("Correct guess!");
            }
            else
            {
              
                ListBox lb = this.Controls.Find("WrongGuess1", true).FirstOrDefault() as ListBox
                             ?? this.Controls.Find("WrongGuess", true).FirstOrDefault() as ListBox;

                if (lb != null)
                    lb.Items.Add(guess);
                else
                    System.Diagnostics.Debug.WriteLine("ListBox for wrong guesses not found (expected 'WrongGuess' or 'WrongGuess1').");

                MessageBox.Show("Wrong guess! Try again.");
            }

            txtGuess.Clear();
            txtGuess.Focus();
        }
    }
}
